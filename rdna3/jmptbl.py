import sys

pkt3s = {}

with open("../f32/pkt3.txt") as f:
    for line in f:
        toks = line.split(' ')
        [pkt_name, opcode] = [toks[0], toks[-1]]
        opcode = int(opcode, 0)
        pkt3s[opcode] = pkt_name

jmptbl = [0x10c68, 0x411ac8, 0xa11848, 0x1010cc0, 0x1110ae0, 0x1210c38,
          0x130e000, 0x150ed98, 0x160edb0, 0x1d0a5d0, 0x1e0a8b8, 0x1f114d8,
          0x2011560, 0x21126a8, 0x2210cd8, 0x2310fd8, 0x240e328, 0x250e3a8,
          0x260dfc8, 0x270e440, 0x2810a88, 0x2a0edf8, 0x2c0e018, 0x2f11e58,
          0x300e788, 0x350e7f8, 0x3709b40, 0x380e840, 0x3c13268, 0x3f0ffc0,
          0x4009c80, 0x42131f8, 0x450ab28, 0x4912ea8, 0x4a11058, 0x4c0eed0,
          0x4d0f1b0, 0x5009f50, 0x5112658, 0x5812c10, 0x59114b8, 0x5d0aa98,
          0x5e11e98, 0x5f11f70, 0x6012150, 0x6112220, 0x6312478, 0x64125a0,
          0x6811d58, 0x77129b8, 0x7a11d98, 0x7d0adc0, 0x7e0ad60, 0x8b108e0,
          0x910e680, 0x9313918, 0x950ad48, 0x9a0a488, 0x9b12af0, 0x9f123b0,
          0xa90ee38, 0xfd10c78, 0xfc10ca8, 0x6128a8, 0x1b128a8, 0x8128c0,
          0x9128e0, 0x1412a80, 0xe03d80, 0x170faa8, 0xd08d50, 0xae0ae20,
          0x4e0fa48, 0xaf0b0c0, 0x46130d0, 0x980acd0, 0xb7114a0, 0xb8126f8,
          0xb912768, 0xba127c8, 0xbb12838, 0xbd12868, 0xb113098, 0xf0108f8,
          0x3412b58, 0xb40b1b0, 0xb015b68, 0xf08eb0, 0xf08eb0, 0xf08eb0,
          0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0,
          0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0,
          0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0,
          0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0,
          0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0, 0xf08eb0,
          0xf08eb0, 0xf08eb0, 0xf08eb0]

jmptbl_me = [0x4256b0, 0xc067c8, 0xe03f50, 0x1025300, 0x1224e68, 0x15068f0,
             0x1606c00, 0x1724cf0, 0x1805b38, 0x1a033f0, 0x1d05f68, 0x1e061e0,
             0x2125b70, 0x2406810, 0x25069d8, 0x27067e8, 0x2825270, 0x2a069c0,
             0x2c081f0, 0x2d067e8, 0x3006928, 0x3427568, 0x35067e8, 0x37058a8,
             0x3808608, 0x3c283d8, 0x3f24bb8, 0x4005088, 0x4506438, 0x4628060,
             0x4927cd0, 0x4a24fc0, 0x4b25330, 0x4c06c58, 0x4d078c0, 0x5005b58,
             0x5125b08, 0x52252a8, 0x5325288, 0x5827818, 0x5e274c0, 0x5f271e0,
             0x6027098, 0x6127138, 0x63272b0, 0x6427360, 0x6825aa0, 0x69257e8,
             0x75253b8, 0x76257e8, 0x7727060, 0x7925808, 0x7a25a68, 0x8907fa0,
             0x8a080b8, 0x9024ba0, 0x9328798, 0x9a06338, 0x9b26f40, 0x9f27410,
             0xa906ae0, 0xfe06b08, 0x7b25ce0, 0x6f25c70, 0x5607000, 0x4e08a60,
             0x65279e8, 0x9404860, 0xae067a0, 0x54254c0, 0xb224d60, 0x9806698,
             0xb625d18, 0xb724e58, 0xb825d30, 0xb925eb0, 0xba26108, 0xbc26268,
             0xbb26370, 0xbe26488, 0xbd264d8, 0xc026538, 0xbf265b0, 0xc226630,
             0xc1266c8, 0xc426770, 0xc326830, 0xc6268f8, 0xc5269d8, 0xc826ac8,
             0xc726bd0, 0xca26ce0, 0xc926e08, 0xb128030, 0x4f07058, 0xb408a90,
             0xb029338, 0xd1285e0, 0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0,
             0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0,
             0x9506740, 0xf033f0, 0xf033f0, 0xf033f0, 0xb306808, 0xf033f0,
             0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0,
             0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0, 0xf033f0, 0x7d06668,
             0x7e06608, 0xf033f0]

if len(sys.argv) > 1 and sys.argv[1] == "me":
    jmptbl = jmptbl_me

for v in jmptbl:
    addr = (v & 0xfffff)
    opcode = v >> 20 & 0xff
    pktname = f"PKT_0x{opcode:x}"
    if (opcode) in pkt3s:
        pktname = pkt3s[opcode]
    print(f"{pktname}({opcode:x}) => {addr:x}")
